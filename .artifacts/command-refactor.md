╭─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮ │
│ │ Command System Refactoring Plan                                                                                                                                                                                                         │ │
│ │                                                                                                                                                                                                                                         │ │
│ │ 🎯 Executive Summary                                                                                                                                                                                                                    │ │
│ │                                                                                                                                                                                                                                         │ │
│ │ Current State: 69 commands, 15 agents, with significant architectural debt                                                                                                                                                              │ │
│ │ Target State: ~35-40 streamlined commands, 15 agents, cleaner separation of concerns                                                                                                                                                    │ │
│ │ Expected Reduction: 40-50% fewer commands while maintaining all functionality                                                                                                                                                           │ │
│ │                                                                                                                                                                                                                                         │ │
│ │ ---                                                                                                                                                                                                                                     │ │
│ │ 📊 Analysis Findings                                                                                                                                                                                                                    │ │
│ │                                                                                                                                                                                                                                         │ │
│ │ Architecture Strengths ✅                                                                                                                                                                                                                │ │
│ │                                                                                                                                                                                                                                         │ │
│ │ 1. 15 Domain Analysts - Well-designed, MECE coverage, proper separation                                                                                                                                                                 │ │
│ │ 2. Workflow Commands - Excellent parallelization (75-85% faster), real value-add                                                                                                                                                        │ │
│ │ 3. Action Commands - Direct operations (git, clean, fix) work well                                                                                                                                                                      │ │
│ │ 4. Artifact Persistence - Context elision pattern works effectively                                                                                                                                                                     │ │
│ │                                                                                                                                                                                                                                         │ │
│ │ Critical Issues ❌                                                                                                                                                                                                                       │ │
│ │                                                                                                                                                                                                                                         │ │
│ │ 1. Atomic Review Command Bloat (14 commands → 1-2 commands)                                                                                                                                                                             │ │
│ │                                                                                                                                                                                                                                         │ │
│ │ Currently: 14 separate /review:* commands that are thin wrappers around analysts                                                                                                                                                        │ │
│ │ - /review:readability → quality-analyst                                                                                                                                                                                                 │ │
│ │ - /review:performance → performance-analyst                                                                                                                                                                                             │ │
│ │ - /review:security → security-analyst                                                                                                                                                                                                   │ │
│ │ - /review:testing → testing-analyst                                                                                                                                                                                                     │ │
│ │ - /review:architecture → architecture-analyst                                                                                                                                                                                           │ │
│ │ - /review:api → api-analyst                                                                                                                                                                                                             │ │
│ │ - /review:database → database-analyst                                                                                                                                                                                                   │ │
│ │ - /review:frontend-architecture → frontend-analyst                                                                                                                                                                                      │ │
│ │ - /review:design → accessibility-analyst + frontend-analyst                                                                                                                                                                             │ │
│ │ - /review:documentation → documentation-analyst                                                                                                                                                                                         │ │
│ │ - /review:observability → quality-analyst                                                                                                                                                                                               │ │
│ │ - /review:style → quality-analyst                                                                                                                                                                                                       │ │
│ │ - /review:code → quality-analyst + multiple analysts                                                                                                                                                                                    │ │
│ │                                                                                                                                                                                                                                         │ │

│ │ Problem: These add zero value - main thread can invoke analysts directly                                                                                                                                                                │ │
│ │ Solution: Replace with 1 commands:                                                                                                                                                                                                    │ │
│ │ - /review:single <domain> - Invoke specific analyst                                                                                                                                                                                     │ │
│ │ - /review:synthesize - Aggregate existing artifacts (DELETE THIS)                                                                                                                                                                         │ │
│ │                                                                                                                                                                                                                                         │ │
│ │ 2. Analysis Command Redundancy (3 commands → 1 command)                                                                                                                                                                                 │ │
│ │                                                                                                                                                                                                                                         │ │
│ │ - /analyze:potential-issues → research-analyst                                                                                                                                                                                          │ │
│ │ - /analyze:performance → performance-analyst                                                                                                                                                                                            │ │
│ │ - /analyze:dependencies → security-analyst + api-analyst                                                                                                                                                                                │ │
│ │                                                                                                                                                                                                                                         │ │
│ │ Solution: Consolidate to /analyze <type> [args] or rely on direct analyst usage                                                                                                                                                         │ │
│ │                                                                                                                                                                                                                                         │ │
│ │ 3. Git Command Confusion (9 commands → 7 commands)                                                                                                                                                                                      │ │
│ │                                                                                                                                                                                                                                         │ │
│ │ - /git:workflow - appears redundant with /git:full-workflow                                                                                                                                                                             │ │
│ │ - /workflows:run-git-branch-commit-and-pr - already deprecated (DELETE THIS)                                                                                                                                                                         │ │
│ │ Solution: Remove /git:workflow, keep atomic git commands + /git:full-workflow                                                                                                                                                           │ │
│ │                                                                                                                                                                                                                                         │ │
│ │ 4. Refactor Command Overlap (6 commands → 3-4 commands)                                                                                                                                                                                 │ │
│ │                                                                                                                                                                                                                                         │ │
│ │ - /refactor:quick, /refactor:extract-functions, /refactor:simplify-logic, /refactor:remove-duplication, /refactor:rename-variables → refactoring-analyst + quality-analyst                                                              │ │
│ │ - /refactor:large-scale - orchestrates analysts (keep this)                                                                                                                                                                             │ │
│ │                                                                                                                                                                                                                                         │ │
│ │ Solution: Consolidate quick refactorings into /refactor:apply <type>, keep /refactor:large-scale  - QUESTION: Should we keep the large-scale refactor command as is, or integrate it into the apply command?                                                                                                                                      │ │
│ │                                                                                                                                                                                                                                         │ │
│ │ 5. Stale Specialist References (77 references to deleted specialists)                                                                                                                                                                   │ │
│ │                                                                                                                                                                                                                                         │ │
│ │ Commands still reference:                                                                                                                                                                                                               │ │
│ │ - implementation-strategy-specialist (deleted)                                                                                                                                                                                          │ │
│ │ - research-analysis-specialist (deleted)                                                                                                                                                                                                │ │
│ │ - code-writer (deleted)                                                                                                                                                                                                                 │ │
│ │ - reviewer (deleted)                                                                                                                                                                                                                    │ │
│ │                                                                                                                                                                                                                                         │ │
│ │ Solution: Update all commands to use current analyst names                                                                                                                                                                              │ │
│ │                                                                                                                                                                                                                                         │ │
│ │ ---                                                                                                                                                                                                                                     │ │
│ │ 🔧 Refactoring Plan                                                                                                                                                                                                                     │ │
│ │                                                                                                                                                                                                                                         │ │
│ │ Phase 1: Atomic Review Command Consolidation (Remove ~12 commands)                                                                                                                                                                      │ │
│ │                                                                                                                                                                                                                                         │ │
│ │ Remove These Commands (agent does the work):                                                                                                                                                                                            │ │
│ │ ❌ /review:readability → USE: quality-analyst directly                                                                                                                                                                                   │ │
│ │ ❌ /review:performance → USE: performance-analyst directly                                                                                                                                                                               │ │
│ │ ❌ /review:security → USE: security-analyst directly                                                                                                                                                                                     │ │
│ │ ❌ /review:testing → USE: testing-analyst directly                                                                                                                                                                                       │ │
│ │ ❌ /review:architecture → USE: architecture-analyst directly                                                                                                                                                                             │ │
│ │ ❌ /review:api → USE: api-analyst directly                                                                                                                                                                                               │ │
│ │ ❌ /review:database → USE: database-analyst directly                                                                                                                                                                                     │ │
│ │ ❌ /review:frontend-architecture → USE: frontend-analyst directly                                                                                                                                                                        │ │
│ │ ❌ /review:design → USE: accessibility-analyst + frontend-analyst                                                                                                                                                                        │ │
│ │ ❌ /review:documentation → USE: documentation-analyst directly                                                                                                                                                                           │ │
│ │ ❌ /review:observability → USE: quality-analyst directly                                                                                                                                                                                 │ │
│ │ ❌ /review:style → USE: quality-analyst directly                                                                                                                                                                                         │ │
│ │                                                                                                                                                                                                                                         │ │
│ │ Keep These Commands (add value):                                                                                                                                                                                                        │ │
│ │ ✅ /review:code → Orchestrates multiple analysts based on file types                                                                                                                                                                     │ │
│ │ ✅ /review:synthesize → Aggregates artifacts into unified report                                                                                                                                                                         │ │
│ │                                                                                                                                                                                                                                         │ │
│ │ Replace With:                                                                                                                                                                                                                           │ │
│ │ - Update main thread to invoke analysts proactively (already supported)                                                                                                                                                                 │ │
│ │ - Optional: Create /review <domain> [args] as thin dispatcher                                                                                                                                                                           │ │
│ │                                                                                                                                                                                                                                         │ │
│ │ Phase 2: Analysis Command Consolidation (Remove ~2 commands)                                                                                                                                                                            │ │
│ │                                                                                                                                                                                                                                         │ │
│ │ Consolidate:                                                                                                                                                                                                                            │ │
│ │ ❌ /analyze:potential-issues → Direct analyst usage                                                                                                                                                                                      │ │
│ │ ❌ /analyze:performance → performance-analyst directly                                                                                                                                                                                   │ │
│ │ ✅ /analyze:dependencies → Keep (specific tooling integration)   DELETE THIS ALSO                                                                                                                                                                        │ │
│ │                                                                                                                                                                                                                                         │ │
│ │ Replace With:                                                                                                                                                                                                                           │ │
│ │ - Main thread uses analysts directly based on context                                                                                                                                                                                   │ │
│ │ - Optional: /analyze <type> [args] dispatcher                                                                                                                                                                                           │ │
│ │                                                                                                                                                                                                                                         │ │
│ │ Phase 3: Git Command Cleanup (Remove 1-2 commands)                                                                                                                                                                                      │ │
│ │                                                                                                                                                                                                                                         │ │
│ │ Remove:                                                                                                                                                                                                                                 │ │
│ │ ❌ /git:workflow → Redundant with /git:full-workflow                                                                                                                                                                                     │ │
│ │ ❌ /workflows:run-git-branch-commit-and-pr → Already deprecated                                                                                                                                                                          │ │
│ │                                                                                                                                                                                                                                         │ │
│ │ Keep: All other git commands (atomic operations + full-workflow)                                                                                                                                                                        │ │
│ │                                                                                                                                                                                                                                         │ │
│ │ Phase 4: Refactor Command Consolidation (Remove ~2 commands)                                                                                                                                                                            │ │
│ │                                                                                                                                                                                                                                         │ │
│ │ Consolidate Quick Refactorings:                                                                                                                                                                                                         │ │
│ │ ❌ /refactor:extract-functions → Part of /refactor:apply                                                                                                                                                                                 │ │
│ │ ❌ /refactor:simplify-logic → Part of /refactor:apply                                                                                                                                                                                    │ │
│ │ ❌ /refactor:remove-duplication → Part of /refactor:apply                                                                                                                                                                                │ │
│ │ ❌ /refactor:rename-variables → Part of /refactor:apply                                                                                                                                                                                  │ │
│ │ ✅ /refactor:quick → Rename to /refactor:apply, absorb others                                                                                                                                                                            │ │
│ │ ✅ /refactor:large-scale → Keep (orchestrates analysts)                                                                                                                                                                                  │ │
│ │                                                                                                                                                                                                                                         │ │
│ │ Phase 5: Update Stale References (No removals, just updates)                                                                                                                                                                            │ │
│ │                                                                                                                                                                                                                                         │ │
│ │ Update all commands to replace deleted specialist references:                                                                                                                                                                           │ │
│ │ - implementation-strategy-specialist → architecture-analyst                                                                                                                                                                             │ │
│ │ - research-analysis-specialist → research-analyst                                                                                                                                                                                       │ │
│ │ - code-writer → Direct implementation or quality-analyst guidance                                                                                                                                                                       │ │
│ │ - reviewer → Appropriate domain analyst                                                                                                                                                                                                 │ │
│ │ - bug-fixer → Direct fix implementation                                                                                                                                                                                                 │ │
│ │ - test-writer → testing-analyst guidance                                                                                                                                                                                                │ │
│ │                                                                                                                                                                                                                                         │ │
│ │ Phase 6: Strengthen Workflow Architecture                                                                                                                                                                                               │ │
│ │                                                                                                                                                                                                                                         │ │
│ │ Keep ALL workflows (they're the power):                                                                                                                                                                                                 │ │
│ │ ✅ /workflows:run-comprehensive-review (parallelizes 6-12 analysts)                                                                                                                                                                      │ │
│ │ ✅ /workflows:run-security-audit (3 analysts parallel)                                                                                                                                                                                   │ │
│ │ ✅ /workflows:run-refactor-workflow (3 analysts parallel)                                                                                                                                                                                │ │
│ │ ✅ /workflows:run-optimization (multiple analysts)                                                                                                                                                                                       │ │
│ │ ✅ /workflows:run-docs-workflow (documentation workflow)                                                                                                                                                                                 │ │
│ │ ✅ /workflows:run-cleanup-workflow (cleanup orchestration)                                                                                                                                                                               │ │
│ │ ✅ /workflows:run-complete-overhaul (10+ analysts parallel)                                                                                                                                                                              │ │
│ │ ✅ /workflows:run-lint-and-correct-all (linting workflow)                                                                                                                                                                                │ │
│ │                                                                                                                                                                                                                                         │ │
│ │ Potentially Add:                                                                                                                                                                                                                        │ │
│ │ - More workflow commands that orchestrate analyst combinations                                                                                                                                                                          │ │
│ │ - This is where 75-85% speed improvements come from                                                                                                                                                                                     │ │
│ │                                                                                                                                                                                                                                         │ │
│ │ ---                                                                                                                                                                                                                                     │ │
│ │ 📈 Expected Outcomes                                                                                                                                                                                                                    │ │
│ │                                                                                                                                                                                                                                         │ │
│ │ Quantitative Improvements                                                                                                                                                                                                               │ │
│ │                                                                                                                                                                                                                                         │ │
│ │ - Commands: 69 → ~35-40 (40-50% reduction)                                                                                                                                                                                              │ │
│ │ - Complexity: Reduced maintenance burden                                                                                                                                                                                                │ │
│ │ - Clarity: Clear separation between workflows (orchestrators) and actions (doers)                                                                                                                                                       │ │
│ │ - Performance: No degradation (analysts do the actual work)                                                                                                                                                                             │ │
│ │                                                                                                                                                                                                                                         │ │
│ │ Architectural Clarity                                                                                                                                                                                                                   │ │
│ │                                                                                                                                                                                                                                         │ │
│ │ 3-Tier Architecture:                                                                                                                                                                                                                    │ │
│ │ Layer 1: Domain Analysts (15) - Analysis experts, persist artifacts                                                                                                                                                                     │ │
│ │ Layer 2: Workflows (8-9) - Orchestrate parallel analyst execution                                                                                                                                                                       │ │
│ │ Layer 3: Actions (20-25) - Direct operations (git, clean, fix, implement, docs)                                                                                                                                                         │ │
│ │                                                                                                                                                                                                                                         │ │
│ │ Anti-Pattern Eliminated: Atomic commands that just wrap single analyst calls                                                                                                                                                            │ │
│ │                                                                                                                                                                                                                                         │ │
│ │ Migration Impact                                                                                                                                                                                                                        │ │
│ │                                                                                                                                                                                                                                         │ │
│ │ - Breaking Changes: Users calling deprecated atomic review commands                                                                                                                                                                     │ │
│ │ - Migration Path: Use analysts directly or use workflows                                                                                                                                                                                │ │
│ │ - Documentation: Update all examples to show direct analyst usage                                                                                                                                                                       │ │
│ │                                                                                                                                                                                                                                         │ │
│ │ ---                                                                                                                                                                                                                                     │ │
│ │ 🚀 Implementation Order                                                                                                                                                                                                                 │ │
│ │                                                                                                                                                                                                                                         │ │
│ │ 1. Week 1: Remove stale specialist references (low risk)                                                                                                                                                                                │ │
│ │ 2. Week 2: Deprecate + remove atomic review commands (document migration)                                                                                                                                                               │ │
│ │ 3. Week 3: Consolidate analysis commands                                                                                                                                                                                                │ │
│ │ 4. Week 4: Clean up git/refactor redundancy                                                                                                                                                                                             │ │
│ │ 5. Week 5: Update documentation, validate all workflows                                                                                                                                                                                 │ │
│ │                                                                                                                                                                                                                                         │ │
│ │ ---                                                                                                                                                                                                                                     │ │
│ │ ✅ Success Criteria                                                                                                                                                                                                                      │ │
│ │                                                                                                                                                                                                                                         │ │
│ │ - Zero stale specialist references                                                                                                                                                                                                      │ │
│ │ - ~35-40 commands (down from 69)                                                                                                                                                                                                        │ │
│ │ - All 15 analysts actively used                                                                                                                                                                                                         │ │
│ │ - All 8-9 workflows functional with parallel execution                                                                                                                                                                                  │ │
│ │ - Clear architectural separation: Analysts → Workflows → Actions                                                                                                                                                                        │ │
│ │ - No functionality regression                                                                                                                                                                                                           │ │
│ │ - Updated documentation reflects new patterns                                                                                                                                                                                           │ │
│ ╰───────────────────────────────────────────────────────
